AmoCRM oAuth 2.0

1. Необходимо создать интеграцию. Дать ей имя, описание, права и ссылку. Ссылку можно указывать любую,
вроде как она ни на что не влияет. Она для работы виджетов.
2. После создания интеграции Необходимо зайти в нее. Там будет 3 ключа. 
ID интеграции
Секретный ключ
Код авторизации - он же Authorization code(этот код действует 20 минут, но может обновится раньше)
Их необходимо вписать в php скрипт get_tokens.php. В комментариях указано куда какое значение вставлять.
Так же указать ту ссылку перенаправления, что была указана в интеграции.
Этот скрипт сделает POST запрос в АМО для получение 2х ключей.
Access token и Refresh token.
Access token - это токен для выполнения обращений к API AmoCRM. (действует сутки, время действия так же возвращает этот запрос)
Refresh token - это токен для обновления Access token'а. (Этот  токен одноразовый. При новом запросе вернется следующий токен.
                                                          Если не использовать его 3 месяца, он так же будет не действительный)
В данный момент скрипт get_tokens.php сохраняет токены в папку /var/www/html/my_apps/tokens Пути можно менять.

Если скрипт возвращает ошибку 400, то возможно нужно взять Authorization code по новой.

3. Далее нужно добавить в cron запуск скрипта get_access_token. Этот скрипт берет refresh токен и с помощью него
запрашивает новую пару токенов.
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Пример строчки в cron для автоматичесого запуска
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

00 3 * * * php /var/www/html/my_apps/functions/get_access_token.php >> /tmp/get_access_token.log 2>&1

# ================================================

Нужно убедится, что в строке "require()" указан верный путь до токена.

Куда будет записываться токен указано в переменных $file в конце скриптов.

Если Refresh token был утерян, то необходимо просто взять новый Authorization code в панели интеграции,
и выполнить первый запрос get_tokens.php.

В папке functions есть пример использования запросов через OAuth2.0. getContact.php
Скрипт ищет контакты для указаного лида. Возвращает id ответственного и id клиента.
